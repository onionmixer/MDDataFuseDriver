# IOCTL/VD Pattern Trace v2

Date: 2026-02-16

# File: w31/extract/mdcache.exe
- decoded_insn_count: 7824
## ioctl_setup_hits
- hits: 3
### hit_1
```asm
0x015f0: call 0x15aa
0x015f3: mov ax, word ptr [bp + 4]
0x015f6: pop di
0x015f7: pop si
0x015f8: pop bp
0x015f9: ret 2
0x015fc: push bp
0x015fd: mov bp, sp
0x015ff: push si
0x01600: push di
0x01601: mov ax, 0x4400
0x01604: mov bx, word ptr [bp + 6]
0x01607: int 0x21
0x01609: xchg dx, ax
0x0160a: and ax, 0x80
0x0160d: pop di
0x0160e: pop si
0x0160f: pop bp
0x01610: retf
0x01611: push bp
```
### hit_2
```asm
0x025b1: pop si
0x025b2: mov sp, bp
0x025b4: pop bp
0x025b5: ret
0x025b6: push bp
0x025b7: mov bp, sp
0x025b9: push si
0x025ba: push di
0x025bb: push ds
0x025bc: lds dx, ptr [bp + 0xa]
0x025bf: mov ah, 0x44
0x025c1: mov al, byte ptr [bp + 8]
0x025c4: mov bx, word ptr [bp + 6]
0x025c7: mov cx, word ptr [bp + 0xe]
0x025ca: int 0x21
0x025cc: pop ds
0x025cd: jb 0x25db
0x025cf: cmp word ptr [bp + 8], 0
0x025d3: jne 0x25d9
0x025d5: mov ax, dx
```
### hit_3
```asm
0x02aae: jb 0x2ab6
0x02ab0: mov ax, 6
0x02ab3: push ax
0x02ab4: jmp 0x2b13
0x02ab6: mov bx, word ptr [bp + 6]
0x02ab9: add bx, bx
0x02abb: test byte ptr [bx + 0x9ab], 2
0x02ac0: je 0x2ac7
0x02ac2: mov ax, 1
0x02ac5: jmp 0x2b16
0x02ac7: mov ax, 0x4400
0x02aca: mov bx, word ptr [bp + 6]
0x02acd: int 0x21
0x02acf: jb 0x2b12
0x02ad1: test dl, 0x80
0x02ad4: jne 0x2b0e
0x02ad6: mov ax, 0x4201
0x02ad9: xor cx, cx
0x02adb: mov dx, cx
0x02add: int 0x21
```

## int21_ioctl_open_hits
- hits: 4
### hit_1
```asm
0x015f8: pop bp
0x015f9: ret 2
0x015fc: push bp
0x015fd: mov bp, sp
0x015ff: push si
0x01600: push di
0x01601: mov ax, 0x4400
0x01604: mov bx, word ptr [bp + 6]
0x01607: int 0x21
0x01609: xchg dx, ax
0x0160a: and ax, 0x80
0x0160d: pop di
```
### hit_2
```asm
0x025b9: push si
0x025ba: push di
0x025bb: push ds
0x025bc: lds dx, ptr [bp + 0xa]
0x025bf: mov ah, 0x44
0x025c1: mov al, byte ptr [bp + 8]
0x025c4: mov bx, word ptr [bp + 6]
0x025c7: mov cx, word ptr [bp + 0xe]
0x025ca: int 0x21
0x025cc: pop ds
0x025cd: jb 0x25db
0x025cf: cmp word ptr [bp + 8], 0
```
### hit_3
```asm
0x02ab6: mov bx, word ptr [bp + 6]
0x02ab9: add bx, bx
0x02abb: test byte ptr [bx + 0x9ab], 2
0x02ac0: je 0x2ac7
0x02ac2: mov ax, 1
0x02ac5: jmp 0x2b16
0x02ac7: mov ax, 0x4400
0x02aca: mov bx, word ptr [bp + 6]
0x02acd: int 0x21
0x02acf: jb 0x2b12
0x02ad1: test dl, 0x80
0x02ad4: jne 0x2b0e
```
### hit_4
```asm
0x0340e: jne 0x3412
0x03410: mov al, 0
0x03412: push ds
0x03413: lds dx, ptr [bp + 6]
0x03416: mov cl, 0xf0
0x03418: and cl, byte ptr [bp + 0xa]
0x0341b: or al, cl
0x0341d: mov ah, 0x3d
0x0341f: int 0x21
0x03421: pop ds
0x03422: jb 0x343e
0x03424: mov word ptr [bp - 2], ax
```

# File: w31/extract/mdfsck.exe
- decoded_insn_count: 22364
## ioctl_setup_hits
- hits: 3
### hit_1
```asm
0x04925: lodsb al, byte ptr [si]
0x04926: sub al, 0x41
0x04928: jb 0x492f
0x0492a: or al, dl
0x0492c: stosb byte ptr es:[di], al
0x0492d: jmp 0x491d
0x0492f: push ss
0x04930: pop ds
0x04931: mov bx, 4
0x04934: and byte ptr [bx + 0x14a6], 0xbf
0x04939: mov ax, 0x4400
0x0493c: int 0x21
0x0493e: jb 0x494a
0x04940: test dl, 0x80
0x04943: je 0x494a
0x04945: or byte ptr [bx + 0x14a6], 0x40
0x0494a: dec bx
0x0494b: jns 0x4934
0x0494d: mov si, 0x1978
0x04950: mov di, 0x1978
```
### hit_2
```asm
0x058a0: xchg bx, ax
0x058a1: mov ax, cx
0x058a3: and ax, 0x500
0x058a6: cmp ax, 0x500
0x058a9: jne 0x58b4
0x058ab: mov ah, 0x3e
0x058ad: int 0x21
0x058af: mov ax, 0x1100
0x058b2: jmp 0x589c
0x058b4: mov byte ptr [bp - 3], 1
0x058b8: mov ax, 0x4400
0x058bb: int 0x21
0x058bd: test dl, 0x80
0x058c0: je 0x58c6
0x058c2: or byte ptr [bp - 4], 0x40
0x058c6: test byte ptr [bp - 4], 0x40
0x058ca: je 0x58cf
0x058cc: jmp 0x59ae
0x058cf: mov ax, word ptr [bp + 0xa]
0x058d2: test ax, 0x200
```
### hit_3
```asm
0x05a90: jmp 0x4d71
0x05a93: cmp cx, 1
0x05a96: je 0x5a9f
0x05a98: cmp byte ptr [si], 0xa
0x05a9b: je 0x5a86
0x05a9d: jmp 0x5a83
0x05a9f: push es
0x05aa0: pop ds
0x05aa1: test byte ptr [bx + 0x14a6], 0x40
0x05aa6: je 0x5ac4
0x05aa8: mov ax, 0x4400
0x05aab: int 0x21
0x05aad: test dx, 0x20
0x05ab1: jne 0x5ac0
0x05ab3: push ds
0x05ab4: push ss
0x05ab5: pop ds
0x05ab6: lea dx, [bp - 1]
0x05ab9: mov ah, 0x3f
0x05abb: int 0x21
```

## int21_ioctl_open_hits
- hits: 5
### hit_1
```asm
0x0492a: or al, dl
0x0492c: stosb byte ptr es:[di], al
0x0492d: jmp 0x491d
0x0492f: push ss
0x04930: pop ds
0x04931: mov bx, 4
0x04934: and byte ptr [bx + 0x14a6], 0xbf
0x04939: mov ax, 0x4400
0x0493c: int 0x21
0x0493e: jb 0x494a
0x04940: test dl, 0x80
0x04943: je 0x494a
```
### hit_2
```asm
0x05874: test byte ptr [0x174d], 0x80
0x05879: jne 0x587f
0x0587b: mov byte ptr [bp - 4], 0x80
0x0587f: push ds
0x05880: lds dx, ptr [bp + 6]
0x05883: and al, 3
0x05885: or al, bh
0x05887: mov ah, 0x3d
0x05889: int 0x21
0x0588b: pop ds
0x0588c: jae 0x58a0
0x0588e: cmp ax, 2
```
### hit_3
```asm
0x058a6: cmp ax, 0x500
0x058a9: jne 0x58b4
0x058ab: mov ah, 0x3e
0x058ad: int 0x21
0x058af: mov ax, 0x1100
0x058b2: jmp 0x589c
0x058b4: mov byte ptr [bp - 3], 1
0x058b8: mov ax, 0x4400
0x058bb: int 0x21
0x058bd: test dl, 0x80
0x058c0: je 0x58c6
0x058c2: or byte ptr [bp - 4], 0x40
```
### hit_4
```asm
0x0597a: mov ah, 0x3e
0x0597c: int 0x21
0x0597e: mov al, byte ptr [bp + 0xa]
0x05981: and al, 3
0x05983: or al, byte ptr [bp - 2]
0x05986: push ds
0x05987: lds dx, ptr [bp + 6]
0x0598a: mov ah, 0x3d
0x0598c: int 0x21
0x0598e: pop ds
0x0598f: jb 0x5969
0x05991: xchg bx, ax
```
### hit_5
```asm
0x05a98: cmp byte ptr [si], 0xa
0x05a9b: je 0x5a86
0x05a9d: jmp 0x5a83
0x05a9f: push es
0x05aa0: pop ds
0x05aa1: test byte ptr [bx + 0x14a6], 0x40
0x05aa6: je 0x5ac4
0x05aa8: mov ax, 0x4400
0x05aab: int 0x21
0x05aad: test dx, 0x20
0x05ab1: jne 0x5ac0
0x05ab3: push ds
```

## vd_string_ref_candidate_hits
- hits: 0

# File: w31/extract/mdfsex.exe
- decoded_insn_count: 160
## ioctl_setup_hits
- hits: 0

## int21_ioctl_open_hits
- hits: 0

